import{f as X,p as $,h as m,s as F,i as S,n as P,k as Q,l as L,t as G,m as T,o as J,q as Z,v as A,w as Y,r as f,x as ee,y as te,c as k,j as s}from"./index-DxkU6T3I.js";import{X as se,a as V}from"./CustomDatePicker-T4IMFbDZ.js";import{C as re}from"./calendar-CMNTU1_T.js";import{F as ae}from"./file-text-CJsyRSEY.js";var ie=class extends X{constructor(e,t){super(),this.options=t,this.#s=e,this.#a=null,this.#r=$(),this.bindMethods(),this.setOptions(t)}#s;#e=void 0;#p=void 0;#t=void 0;#n;#h;#r;#a;#m;#d;#u;#o;#l;#i;#f=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#e.addObserver(this),B(this.#e,this.options)?this.#c():this.updateResult(),this.#y())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return U(this.#e,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return U(this.#e,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#v(),this.#w(),this.#e.removeObserver(this)}setOptions(e){const t=this.options,r=this.#e;if(this.options=this.#s.defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof m(this.options.enabled,this.#e)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#R(),this.#e.setOptions(this.options),t._defaulted&&!F(this.options,t)&&this.#s.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#e,observer:this});const a=this.hasListeners();a&&H(this.#e,r,this.options,t)&&this.#c(),this.updateResult(),a&&(this.#e!==r||m(this.options.enabled,this.#e)!==m(t.enabled,this.#e)||S(this.options.staleTime,this.#e)!==S(t.staleTime,this.#e))&&this.#g();const i=this.#b();a&&(this.#e!==r||m(this.options.enabled,this.#e)!==m(t.enabled,this.#e)||i!==this.#i)&&this.#x(i)}getOptimisticResult(e){const t=this.#s.getQueryCache().build(this.#s,e),r=this.createResult(t,e);return oe(this,r)&&(this.#t=r,this.#h=this.options,this.#n=this.#e.state),r}getCurrentResult(){return this.#t}trackResult(e,t){return new Proxy(e,{get:(r,a)=>(this.trackProp(a),t?.(a),a==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#r.status==="pending"&&this.#r.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,a))})}trackProp(e){this.#f.add(e)}getCurrentQuery(){return this.#e}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=this.#s.defaultQueryOptions(e),r=this.#s.getQueryCache().build(this.#s,t);return r.fetch().then(()=>this.createResult(r,t))}fetch(e){return this.#c({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#t))}#c(e){this.#R();let t=this.#e.fetch(this.options,e);return e?.throwOnError||(t=t.catch(P)),t}#g(){this.#v();const e=S(this.options.staleTime,this.#e);if(Q||this.#t.isStale||!L(e))return;const r=G(this.#t.dataUpdatedAt,e)+1;this.#o=T.setTimeout(()=>{this.#t.isStale||this.updateResult()},r)}#b(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#e):this.options.refetchInterval)??!1}#x(e){this.#w(),this.#i=e,!(Q||m(this.options.enabled,this.#e)===!1||!L(this.#i)||this.#i===0)&&(this.#l=T.setInterval(()=>{(this.options.refetchIntervalInBackground||J.isFocused())&&this.#c()},this.#i))}#y(){this.#g(),this.#x(this.#b())}#v(){this.#o&&(T.clearTimeout(this.#o),this.#o=void 0)}#w(){this.#l&&(T.clearInterval(this.#l),this.#l=void 0)}createResult(e,t){const r=this.#e,a=this.options,i=this.#t,d=this.#n,n=this.#h,c=e!==r?e.state:this.#p,{state:u}=e;let l={...u},w=!1,h;if(t._optimisticResults){const p=this.hasListeners(),D=!p&&B(e,t),R=p&&H(e,r,t,a);(D||R)&&(l={...l,...Z(u.data,e.options)}),t._optimisticResults==="isRestoring"&&(l.fetchStatus="idle")}let{error:j,errorUpdatedAt:C,status:x}=l;h=l.data;let N=!1;if(t.placeholderData!==void 0&&h===void 0&&x==="pending"){let p;i?.isPlaceholderData&&t.placeholderData===n?.placeholderData?(p=i.data,N=!0):p=typeof t.placeholderData=="function"?t.placeholderData(this.#u?.state.data,this.#u):t.placeholderData,p!==void 0&&(x="success",h=A(i?.data,p,t),w=!0)}if(t.select&&h!==void 0&&!N)if(i&&h===d?.data&&t.select===this.#m)h=this.#d;else try{this.#m=t.select,h=t.select(h),h=A(i?.data,h,t),this.#d=h,this.#a=null}catch(p){this.#a=p}this.#a&&(j=this.#a,h=this.#d,C=Date.now(),x="error");const o=l.fetchStatus==="fetching",y=x==="pending",v=x==="error",E=y&&o,O=h!==void 0,g={status:x,fetchStatus:l.fetchStatus,isPending:y,isSuccess:x==="success",isError:v,isInitialLoading:E,isLoading:E,data:h,dataUpdatedAt:l.dataUpdatedAt,error:j,errorUpdatedAt:C,failureCount:l.fetchFailureCount,failureReason:l.fetchFailureReason,errorUpdateCount:l.errorUpdateCount,isFetched:l.dataUpdateCount>0||l.errorUpdateCount>0,isFetchedAfterMount:l.dataUpdateCount>c.dataUpdateCount||l.errorUpdateCount>c.errorUpdateCount,isFetching:o,isRefetching:o&&!y,isLoadingError:v&&!O,isPaused:l.fetchStatus==="paused",isPlaceholderData:w,isRefetchError:v&&O,isStale:z(e,t),refetch:this.refetch,promise:this.#r,isEnabled:m(t.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const p=M=>{g.status==="error"?M.reject(g.error):g.data!==void 0&&M.resolve(g.data)},D=()=>{const M=this.#r=g.promise=$();p(M)},R=this.#r;switch(R.status){case"pending":e.queryHash===r.queryHash&&p(R);break;case"fulfilled":(g.status==="error"||g.data!==R.value)&&D();break;case"rejected":(g.status!=="error"||g.error!==R.reason)&&D();break}}return g}updateResult(){const e=this.#t,t=this.createResult(this.#e,this.options);if(this.#n=this.#e.state,this.#h=this.options,this.#n.data!==void 0&&(this.#u=this.#e),F(t,e))return;this.#t=t;const r=()=>{if(!e)return!0;const{notifyOnChangeProps:a}=this.options,i=typeof a=="function"?a():a;if(i==="all"||!i&&!this.#f.size)return!0;const d=new Set(i??this.#f);return this.options.throwOnError&&d.add("error"),Object.keys(this.#t).some(n=>{const b=n;return this.#t[b]!==e[b]&&d.has(b)})};this.#S({listeners:r()})}#R(){const e=this.#s.getQueryCache().build(this.#s,this.options);if(e===this.#e)return;const t=this.#e;this.#e=e,this.#p=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#y()}#S(e){Y.batch(()=>{e.listeners&&this.listeners.forEach(t=>{t(this.#t)}),this.#s.getQueryCache().notify({query:this.#e,type:"observerResultsUpdated"})})}};function ne(e,t){return m(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function B(e,t){return ne(e,t)||e.state.data!==void 0&&U(e,t,t.refetchOnMount)}function U(e,t,r){if(m(t.enabled,e)!==!1&&S(t.staleTime,e)!=="static"){const a=typeof r=="function"?r(e):r;return a==="always"||a!==!1&&z(e,t)}return!1}function H(e,t,r,a){return(e!==t||m(a.enabled,e)===!1)&&(!r.suspense||e.state.status!=="error")&&z(e,r)}function z(e,t){return m(t.enabled,e)!==!1&&e.isStaleByTime(S(t.staleTime,e))}function oe(e,t){return!F(e.getCurrentResult(),t)}var K=f.createContext(!1),le=()=>f.useContext(K);K.Provider;function ce(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var he=f.createContext(ce()),de=()=>f.useContext(he),ue=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},fe=e=>{f.useEffect(()=>{e.clearReset()},[e])},pe=({result:e,errorResetBoundary:t,throwOnError:r,query:a,suspense:i})=>e.isError&&!t.isReset()&&!e.isFetching&&a&&(i&&e.data===void 0||ee(r,[e.error,a])),me=e=>{if(e.suspense){const r=i=>i==="static"?i:Math.max(i??1e3,1e3),a=e.staleTime;e.staleTime=typeof a=="function"?(...i)=>r(a(...i)):r(a),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},ge=(e,t)=>e.isLoading&&e.isFetching&&!t,be=(e,t)=>e?.suspense&&t.isPending,q=(e,t,r)=>t.fetchOptimistic(e).catch(()=>{r.clearReset()});function xe(e,t,r){const a=le(),i=de(),d=te(),n=d.defaultQueryOptions(e);d.getDefaultOptions().queries?._experimental_beforeQuery?.(n),n._optimisticResults=a?"isRestoring":"optimistic",me(n),ue(n,i),fe(i);const b=!d.getQueryCache().get(n.queryHash),[c]=f.useState(()=>new t(d,n)),u=c.getOptimisticResult(n),l=!a&&e.subscribed!==!1;if(f.useSyncExternalStore(f.useCallback(w=>{const h=l?c.subscribe(Y.batchCalls(w)):P;return c.updateResult(),h},[c,l]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),f.useEffect(()=>{c.setOptions(n)},[n,c]),be(n,u))throw q(n,c,i);if(pe({result:u,errorResetBoundary:i,throwOnError:n.throwOnError,query:d.getQueryCache().get(n.queryHash),suspense:n.suspense}))throw u.error;return d.getDefaultOptions().queries?._experimental_afterQuery?.(n,u),n.experimental_prefetchInRender&&!Q&&ge(u,a)&&(b?q(n,c,i):d.getQueryCache().get(n.queryHash)?.promise)?.catch(P).finally(()=>{c.updateResult()}),n.notifyOnChangeProps?u:c.trackResult(u)}function Te(e,t){return xe(e,ie)}const ye=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],W=k("download",ye);const ve=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Ie=k("package",ve);const we=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Re=k("sparkles",we);const Se=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ke=k("square-check-big",Se);const je=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Ce=k("square",je),I=()=>{const e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`},Ne=e=>{const t=new Date;return t.setDate(t.getDate()-e),`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`},Ee=()=>{const e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-01`};function Fe({isOpen:e,onClose:t,exportType:r="orders"}){const[a,i]=f.useState("today"),[d,n]=f.useState(""),[b,c]=f.useState(""),[u,l]=f.useState({token:!0,token_date:!0,entry_date:!0,customer:!0,delivery_date:!0,amount:!0,status:!0,payment_method:!0,remarks:!1});if(!e)return null;const w=o=>{l(y=>({...y,[o]:!y[o]}))},h=()=>{switch(a){case"today":return{from:I(),to:I()};case"week":return{from:Ne(7),to:I()};case"month":return{from:Ee(),to:I()};case"custom":return{from:d,to:b};default:return{from:"",to:""}}},j=()=>{const{from:o,to:y}=h(),v=new URLSearchParams;o&&v.append("date_from",o),y&&v.append("date_to",y);const E=Object.entries(u).filter(([,_])=>_).map(([_])=>_);v.append("fields",E.join(","));const O=r==="collections"?"/api/export/collections":"/api/export/orders";window.open(`${O}?${v}`,"_blank"),t()},C=[{id:"today",label:"Today",icon:"ðŸ“…"},{id:"week",label:"Last 7 Days",icon:"ðŸ“†"},{id:"month",label:"This Month",icon:"ðŸ—“ï¸"},{id:"custom",label:"Custom",icon:"âš™ï¸"}],x=[{id:"token",label:"Token No."},{id:"token_date",label:"Token Date"},{id:"entry_date",label:"Entry Date"},{id:"customer",label:"Customer Name"},{id:"delivery_date",label:"Delivery Date"},{id:"amount",label:"Amount"},{id:"status",label:"Status"},{id:"payment_method",label:"Payment Method"},{id:"remarks",label:"Remarks"}],N=Object.values(u).filter(Boolean).length;return s.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center",onClick:t,children:[s.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-md"}),s.jsxs("div",{className:"relative bg-white rounded-t-3xl sm:rounded-3xl w-full max-w-md shadow-2xl overflow-hidden max-h-[80vh] sm:max-h-[85vh] flex flex-col animate-in slide-in-from-bottom duration-300 mb-20 sm:mb-0",onClick:o=>o.stopPropagation(),children:[s.jsxs("div",{className:"relative overflow-hidden flex-shrink-0",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-[#075E54] via-[#128C7E] to-[#25D366]"}),s.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:"radial-gradient(circle at 20% 50%, rgba(255,255,255,0.2) 1px, transparent 1px)",backgroundSize:"20px 20px"}}),s.jsx("div",{className:"relative p-5",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center backdrop-blur-sm",children:s.jsx(W,{size:20,className:"text-white"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-bold text-white",children:"Export Data"}),s.jsx("p",{className:"text-xs text-white/70",children:"Download as CSV file"})]})]}),s.jsx("button",{onClick:t,className:"w-8 h-8 rounded-full bg-white/20 hover:bg-white/30 flex items-center justify-center transition-colors",children:s.jsx(se,{size:18,className:"text-white"})})]})})]}),s.jsxs("div",{className:"p-5 space-y-5 overflow-y-auto flex-1 bg-gray-50/50",children:[s.jsxs("div",{className:"bg-white rounded-2xl p-4 shadow-sm border border-gray-100",children:[s.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider flex items-center gap-2 mb-3",children:[s.jsx(re,{size:14,className:"text-teal-600"}),"Date Range"]}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:C.map(o=>s.jsxs("button",{onClick:()=>i(o.id),className:`py-3 px-4 rounded-xl text-sm font-bold transition-all flex items-center gap-2 ${a===o.id?"bg-gradient-to-r from-[#25D366] to-[#128C7E] text-white shadow-lg shadow-green-500/25":"bg-gray-100 text-gray-600 hover:bg-gray-200 active:scale-[0.98]"}`,children:[s.jsx("span",{children:o.icon}),o.label]},o.id))}),a==="custom"&&s.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-4 p-4 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl border border-gray-200",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase mb-2 block",children:"From Date"}),s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-2",children:s.jsx(V,{selected:d,onChange:n,placeholder:"Start date"})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-[10px] font-bold text-gray-500 uppercase mb-2 block",children:"To Date"}),s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-2",children:s.jsx(V,{selected:b,onChange:c,placeholder:"End date"})})]})]})]}),s.jsxs("div",{className:"bg-white rounded-2xl p-4 shadow-sm border border-gray-100",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider flex items-center gap-2",children:[s.jsx(ae,{size:14,className:"text-teal-600"}),"Include Fields"]}),s.jsxs("span",{className:"text-xs font-bold text-teal-600 bg-teal-50 px-2 py-1 rounded-full",children:[N," selected"]})]}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:x.map(o=>s.jsxs("button",{onClick:()=>w(o.id),className:`py-2.5 px-3 rounded-xl text-sm font-medium transition-all flex items-center gap-2 active:scale-[0.98] ${u[o.id]?"bg-gradient-to-r from-green-50 to-emerald-50 text-green-700 border-2 border-green-300 shadow-sm":"bg-gray-50 text-gray-500 border-2 border-gray-100 hover:border-gray-200"}`,children:[u[o.id]?s.jsx(ke,{size:16,className:"text-green-600 flex-shrink-0"}):s.jsx(Ce,{size:16,className:"text-gray-400 flex-shrink-0"}),s.jsx("span",{className:"truncate text-xs font-semibold",children:o.label})]},o.id))})]})]}),s.jsx("div",{className:"p-5 border-t border-gray-100 flex-shrink-0 bg-white",children:s.jsxs("button",{onClick:j,className:"w-full py-4 rounded-2xl font-bold bg-gradient-to-r from-[#075E54] via-[#128C7E] to-[#25D366] text-white shadow-xl shadow-green-500/30 active:scale-[0.98] transition-all flex items-center justify-center gap-3 text-base",children:[s.jsx(W,{size:20}),"Export to CSV",s.jsx(Re,{size:16,className:"opacity-70"})]})})]})]})}export{W as D,Fe as E,Ie as P,Te as u};
